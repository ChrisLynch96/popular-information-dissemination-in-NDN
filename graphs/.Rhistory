y.only <- data[,c(2,3,11,12,13,14,15,16,17)]
fy.only <- y.only[,-2]
fy.imp <- mice(fy.only,m=5,maxit=50,seed = 500)
fy.complete <- complete(fy.imp, 1)
g0y.only <- subset(y.only, group==0)
g0y.imp <- mice(g0y.only,m=5,maxit=50,seed=500)
g0y.complete <- complete(g0y.imp, 1)
g1y.only <- subset(y.only, group==1)
g1y.imp <- mice(g1y.only,m=5,maxit=50,seed=500)
g1y.complete <- complete(g1y.imp, 1)
### Combining X and Y variables
f.complete <- cbind(fx.complete, fy.complete[,-1])
g0.complete <- cbind(g0x.complete, g0y.complete[,-1])
g1.complete <- cbind(g1x.complete, g1y.complete[,-1])
sub_sets <- list (
f.complete,
g0.complete,
g1.complete
)
formulas <- list(
Response~X1 + X2 + X3 + X4 + X5 + X6 + X7,
Response~Y1 + Y2 + Y3 + Y4 + Y5 + Y6 + Y7,
Response~X1 + X2 + X3 + X4 + X5 + X6 + X7 + Y1 + Y2 + Y3 + Y4 + Y5 + Y6 + Y7
)
## Model creation
models <- list()
xerrors <- list()
cps <- list()
count = 1
for(i in seq(length(sub_sets))) {
for(j in seq(length(formulas))) {
model <- rpart(formula = formulas[[j]], data = sub_sets[[i]], parms=list(split="information"), method = "class")
opt <- which.min(model$cptable[,"xerror"])
models[count] <- model
xerrors[count] <- model$cptable[opt, "xerror"]
cps[count] <- model$cptable[opt, "CP"]
count = count + 1
}
}
rm(list = ls())
setwd("~/workspace/github.com/ChrisLynch96/data-analytics/assignments/assign3")
library(readxl)
library(mice)
library(rpart)
library(partykit)
data <- read_excel("Project Data.xlsx")
x.only <- data[,c(2,3,4,5,6,7,8,9,10)]
summary(x.only)
fx.only <- x.only[,-2]
summary(fx.only)
fx.imp <- mice(fx.only,m=5,maxit=50,meth='pmm',seed=500)
fx.complete <- complete(fx.imp, 1)
summary(fx.complete)
g0x.only <- subset(x.only, group==0)
summary(x.only)
g0x.only <- subset(x.only, Group==0)
summary(g0x.only)
g0x.only
g0x.only$Group
g0x.only <- g0x.only[,-2]
summary(g0x.only)
g0x.imp <- mice(g0x.only,m=5,maxit=50,meth='pmm',seed=500)
g0x.complete <- complete(g0x.imp, 1)
summary(g0x.complete)
g1x.only <- subset(x.only, Group==1)
summary(g1x.complete)
summary(g1x.only)
g1x.imp <- mice(g1x.only,m=5,maxit=50,meth='pmm',seed=500)
g1x.complete <- complete(g1x.imp, 1)
summary(g1x.complete)
y.only <- data[,c(2,3,11,12,13,14,15,16,17)]
fy.only <- y.only[,-2]
fy.imp <- mice(fy.only,m=5,maxit=50,seed = 500)
fy.complete <- complete(fy.imp, 1)
summary(g0y.complete)
summary(fy.complete)
g0y.only <- subset(y.only, Group==0)
g0y.only <- g0y.only[,-2]
g0y.imp <- mice(g0y.only,m=5,maxit=50,seed=500)
g0y.complete <- complete(g0y.imp, 1)
summary(g0y.compelte)
summary(g0y.complete)
g1y.only <- subset(y.only, Group==1)
g1y.imp <- mice(g1y.only,m=5,maxit=50,seed=500)
g1y.complete <- complete(g1y.imp, 1)
f.complete <- cbind(fx.complete, fy.complete[,-1])
g0.complete <- cbind(g0x.complete, g0y.complete[,-1])
g1.complete <- cbind(g1x.complete, g1y.complete[,-1])
summary(f.complete)
summary(g0.complete)
summary(g1.complete)
sub_sets <- list (
f.complete,
g0.complete,
g1.complete
)
formulas <- list(
Response~X1 + X2 + X3 + X4 + X5 + X6 + X7,
Response~Y1 + Y2 + Y3 + Y4 + Y5 + Y6 + Y7,
Response~X1 + X2 + X3 + X4 + X5 + X6 + X7 + Y1 + Y2 + Y3 + Y4 + Y5 + Y6 + Y7
)
models <- list()
xerrors <- list()
cps <- list()
count = 1
for(i in seq(length(sub_sets))) {
for(j in seq(length(formulas))) {
model <- rpart(formula = formulas[[j]], data = sub_sets[[i]], parms=list(split="information"), method = "class")
opt <- which.min(model$cptable[,"xerror"])
models[count] <- model
xerrors[count] <- model$cptable[opt, "xerror"]
cps[count] <- model$cptable[opt, "CP"]
count = count + 1
}
}
printcp(models[[1]])
class(models[[1]])
cps
xerrors
# Assignmen 3: Data imputation
## Setup
rm(list = ls())
setwd("~/workspace/github.com/ChrisLynch96/data-analytics/assignments/assign3")
library(readxl)
library(mice)
library(rpart)
library(partykit)
data <- read_excel("Project Data.xlsx")
## Imputing
### imputing only the Xs
x.only <- data[,c(2,3,4,5,6,7,8,9,10)]
fx.only <- x.only[,-2]
fx.imp <- mice(fx.only,m=5,maxit=50,meth='pmm',seed=500)
fx.complete <- complete(fx.imp, 1)
g0x.only <- subset(x.only, Group==0)
g0x.only <- g0x.only[,-2]
g0x.imp <- mice(g0x.only,m=5,maxit=50,meth='pmm',seed=500)
g0x.complete <- complete(g0x.imp, 1)
g1x.only <- subset(x.only, Group==1)
g1x.imp <- mice(g1x.only,m=5,maxit=50,meth='pmm',seed=500)
g1x.complete <- complete(g1x.imp, 1)
### imputing only the Ys
y.only <- data[,c(2,3,11,12,13,14,15,16,17)]
fy.only <- y.only[,-2]
fy.imp <- mice(fy.only,m=5,maxit=50,seed = 500)
fy.complete <- complete(fy.imp, 1)
g0y.only <- subset(y.only, Group==0)
g0y.only <- g0y.only[,-2]
g0y.imp <- mice(g0y.only,m=5,maxit=50,seed=500)
g0y.complete <- complete(g0y.imp, 1)
g1y.only <- subset(y.only, Group==1)
g1y.imp <- mice(g1y.only,m=5,maxit=50,seed=500)
g1y.complete <- complete(g1y.imp, 1)
### Combining X and Y variables
f.complete <- cbind(fx.complete, fy.complete[,-1])
g0.complete <- cbind(g0x.complete, g0y.complete[,-1])
g1.complete <- cbind(g1x.complete, g1y.complete[,-1])
sub_sets <- list (
f.complete,
g0.complete,
g1.complete
)
formulas <- list(
Response~X1 + X2 + X3 + X4 + X5 + X6 + X7,
Response~Y1 + Y2 + Y3 + Y4 + Y5 + Y6 + Y7,
Response~X1 + X2 + X3 + X4 + X5 + X6 + X7 + Y1 + Y2 + Y3 + Y4 + Y5 + Y6 + Y7
)
## Model creation
models <- list()
xerrors <- list()
cps <- list()
count = 1
pdf("plots.pdf")
for(i in seq(length(sub_sets))) {
for(j in seq(length(formulas))) {
model <- rpart(formula = formulas[[j]], data = sub_sets[[i]], parms=list(split="information"), method = "class")
opt <- which.min(model$cptable[,"xerror"])
pruned_model <- prune(model, cp = model$cptable[opt, "CP"])
plot(as.party(pruned_model))
xerrors[count] <- model$cptable[opt, "xerror"]
cps[count] <- model$cptable[opt, "CP"]
count = count + 1
}
}
dev.off()
cps
xerrors
# Assignmen 3: Data imputation
## Setup
rm(list = ls())
setwd("~/workspace/github.com/ChrisLynch96/data-analytics/assignments/assign3")
library(readxl)
library(mice)
library(rpart)
library(partykit)
data <- read_excel("Project Data.xlsx")
## Imputing
### imputing only the Xs
x.only <- data[,c(2,3,4,5,6,7,8,9,10)]
fx.only <- x.only[,-2]
fx.imp <- mice(fx.only,m=5,maxit=50,meth='pmm',seed=500)
fx.complete <- complete(fx.imp, 1)
g0x.only <- subset(x.only, Group==0)
g0x.only <- g0x.only[,-2]
g0x.imp <- mice(g0x.only,m=5,maxit=50,meth='pmm',seed=500)
g0x.complete <- complete(g0x.imp, 1)
g1x.only <- subset(x.only, Group==1)
g1x.imp <- mice(g1x.only,m=5,maxit=50,meth='pmm',seed=500)
g1x.complete <- complete(g1x.imp, 1)
### imputing only the Ys
y.only <- data[,c(2,3,11,12,13,14,15,16,17)]
fy.only <- y.only[,-2]
fy.imp <- mice(fy.only,m=5,maxit=50,seed = 500)
fy.complete <- complete(fy.imp, 1)
g0y.only <- subset(y.only, Group==0)
g0y.only <- g0y.only[,-2]
g0y.imp <- mice(g0y.only,m=5,maxit=50,seed=500)
g0y.complete <- complete(g0y.imp, 1)
g1y.only <- subset(y.only, Group==1)
g1y.imp <- mice(g1y.only,m=5,maxit=50,seed=500)
g1y.complete <- complete(g1y.imp, 1)
### Combining X and Y variables
f.complete <- cbind(fx.complete, fy.complete[,-1])
g0.complete <- cbind(g0x.complete, g0y.complete[,-1])
g1.complete <- cbind(g1x.complete, g1y.complete[,-1])
sub_sets <- list (
f.complete,
g0.complete,
g1.complete
)
formulas <- list(
Response~X1 + X2 + X3 + X4 + X5 + X6 + X7,
Response~Y1 + Y2 + Y3 + Y4 + Y5 + Y6 + Y7,
Response~X1 + X2 + X3 + X4 + X5 + X6 + X7 + Y1 + Y2 + Y3 + Y4 + Y5 + Y6 + Y7
)
## Model creation
models <- list()
xerrors <- list()
cps <- list()
count = 1
pdf("plots1.pdf", width = square, height = square)
for(i in seq(length(sub_sets))) {
for(j in seq(length(formulas))) {
model <- rpart(formula = formulas[[j]], data = sub_sets[[i]], parms=list(split="information"), method = "class")
opt <- which.min(model$cptable[,"xerror"])
pruned_model <- prune(model, cp = model$cptable[opt, "CP"])
plot(as.party(pruned_model))
xerrors[count] <- model$cptable[opt, "xerror"]
cps[count] <- model$cptable[opt, "CP"]
count = count + 1
}
}
dev.off()
## Dustbin
#
#fx.noimp <- rpart(formula = formulas[[1]], data = data, parms=list(split="information"), method = "class")
#fy.noimp <- rpart(formula = formulas[[2]], data = data, parms=list(split="information"), method = "class")
#fxy.noimp <- rpart(formula = formulas[[3]], data = data, parms=list(split="information"), method = "class")
## Model creation with imputation
#fx.withimp <- rpart(formula = formulas[[1]], data = x.complete, parms=list(split="information"), method = "class")
#fy.withimp <- rpart(formula = formulas[[2]], data = y.complete, parms=list(split="information"), method = "class")
#fxy.withimp <- rpart(formula = formulas[[3]], data = full.complete, parms=list(split="information"), method = "class")
# Assignmen 3: Data imputation
## Setup
rm(list = ls())
setwd("~/workspace/github.com/ChrisLynch96/data-analytics/assignments/assign3")
library(readxl)
library(mice)
library(rpart)
library(partykit)
data <- read_excel("Project Data.xlsx")
## Imputing
### imputing only the Xs
x.only <- data[,c(2,3,4,5,6,7,8,9,10)]
fx.only <- x.only[,-2]
fx.imp <- mice(fx.only,m=5,maxit=50,meth='pmm',seed=500)
fx.complete <- complete(fx.imp, 1)
g0x.only <- subset(x.only, Group==0)
g0x.only <- g0x.only[,-2]
g0x.imp <- mice(g0x.only,m=5,maxit=50,meth='pmm',seed=500)
g0x.complete <- complete(g0x.imp, 1)
g1x.only <- subset(x.only, Group==1)
g1x.imp <- mice(g1x.only,m=5,maxit=50,meth='pmm',seed=500)
g1x.complete <- complete(g1x.imp, 1)
### imputing only the Ys
y.only <- data[,c(2,3,11,12,13,14,15,16,17)]
fy.only <- y.only[,-2]
fy.imp <- mice(fy.only,m=5,maxit=50,seed = 500)
fy.complete <- complete(fy.imp, 1)
g0y.only <- subset(y.only, Group==0)
g0y.only <- g0y.only[,-2]
g0y.imp <- mice(g0y.only,m=5,maxit=50,seed=500)
g0y.complete <- complete(g0y.imp, 1)
g1y.only <- subset(y.only, Group==1)
g1y.imp <- mice(g1y.only,m=5,maxit=50,seed=500)
g1y.complete <- complete(g1y.imp, 1)
### Combining X and Y variables
f.complete <- cbind(fx.complete, fy.complete[,-1])
g0.complete <- cbind(g0x.complete, g0y.complete[,-1])
g1.complete <- cbind(g1x.complete, g1y.complete[,-1])
sub_sets <- list (
f.complete,
g0.complete,
g1.complete
)
formulas <- list(
Response~X1 + X2 + X3 + X4 + X5 + X6 + X7,
Response~Y1 + Y2 + Y3 + Y4 + Y5 + Y6 + Y7,
Response~X1 + X2 + X3 + X4 + X5 + X6 + X7 + Y1 + Y2 + Y3 + Y4 + Y5 + Y6 + Y7
)
## Model creation
models <- list()
xerrors <- list()
cps <- list()
count = 1
pdf("plots1.pdf", width = 600, height = 600)
for(i in seq(length(sub_sets))) {
for(j in seq(length(formulas))) {
model <- rpart(formula = formulas[[j]], data = sub_sets[[i]], parms=list(split="information"), method = "class")
opt <- which.min(model$cptable[,"xerror"])
pruned_model <- prune(model, cp = model$cptable[opt, "CP"])
plot(as.party(pruned_model))
xerrors[count] <- model$cptable[opt, "xerror"]
cps[count] <- model$cptable[opt, "CP"]
count = count + 1
}
}
dev.off()
## Dustbin
#
#fx.noimp <- rpart(formula = formulas[[1]], data = data, parms=list(split="information"), method = "class")
#fy.noimp <- rpart(formula = formulas[[2]], data = data, parms=list(split="information"), method = "class")
#fxy.noimp <- rpart(formula = formulas[[3]], data = data, parms=list(split="information"), method = "class")
## Model creation with imputation
#fx.withimp <- rpart(formula = formulas[[1]], data = x.complete, parms=list(split="information"), method = "class")
#fy.withimp <- rpart(formula = formulas[[2]], data = y.complete, parms=list(split="information"), method = "class")
#fxy.withimp <- rpart(formula = formulas[[3]], data = full.complete, parms=list(split="information"), method = "class")
# Assignmen 3: Data imputation
## Setup
rm(list = ls())
setwd("~/workspace/github.com/ChrisLynch96/data-analytics/assignments/assign3")
library(readxl)
library(mice)
library(rpart)
library(partykit)
data <- read_excel("Project Data.xlsx")
## Imputing
### imputing only the Xs
x.only <- data[,c(2,3,4,5,6,7,8,9,10)]
fx.only <- x.only[,-2]
fx.imp <- mice(fx.only,m=5,maxit=50,meth='pmm',seed=500)
fx.complete <- complete(fx.imp, 1)
g0x.only <- subset(x.only, Group==0)
g0x.only <- g0x.only[,-2]
g0x.imp <- mice(g0x.only,m=5,maxit=50,meth='pmm',seed=500)
g0x.complete <- complete(g0x.imp, 1)
g1x.only <- subset(x.only, Group==1)
g1x.imp <- mice(g1x.only,m=5,maxit=50,meth='pmm',seed=500)
g1x.complete <- complete(g1x.imp, 1)
### imputing only the Ys
y.only <- data[,c(2,3,11,12,13,14,15,16,17)]
fy.only <- y.only[,-2]
fy.imp <- mice(fy.only,m=5,maxit=50,seed = 500)
fy.complete <- complete(fy.imp, 1)
g0y.only <- subset(y.only, Group==0)
g0y.only <- g0y.only[,-2]
g0y.imp <- mice(g0y.only,m=5,maxit=50,seed=500)
g0y.complete <- complete(g0y.imp, 1)
g1y.only <- subset(y.only, Group==1)
g1y.imp <- mice(g1y.only,m=5,maxit=50,seed=500)
g1y.complete <- complete(g1y.imp, 1)
### Combining X and Y variables
f.complete <- cbind(fx.complete, fy.complete[,-1])
g0.complete <- cbind(g0x.complete, g0y.complete[,-1])
g1.complete <- cbind(g1x.complete, g1y.complete[,-1])
sub_sets <- list (
f.complete,
g0.complete,
g1.complete
)
formulas <- list(
Response~X1 + X2 + X3 + X4 + X5 + X6 + X7,
Response~Y1 + Y2 + Y3 + Y4 + Y5 + Y6 + Y7,
Response~X1 + X2 + X3 + X4 + X5 + X6 + X7 + Y1 + Y2 + Y3 + Y4 + Y5 + Y6 + Y7
)
## Model creation
models <- list()
xerrors <- list()
cps <- list()
count = 1
pdf("plots1.pdf", width = 9, height = 9)
for(i in seq(length(sub_sets))) {
for(j in seq(length(formulas))) {
model <- rpart(formula = formulas[[j]], data = sub_sets[[i]], parms=list(split="information"), method = "class")
opt <- which.min(model$cptable[,"xerror"])
pruned_model <- prune(model, cp = model$cptable[opt, "CP"])
plot(as.party(pruned_model))
xerrors[count] <- model$cptable[opt, "xerror"]
cps[count] <- model$cptable[opt, "CP"]
count = count + 1
}
}
dev.off()
## Dustbin
#
#fx.noimp <- rpart(formula = formulas[[1]], data = data, parms=list(split="information"), method = "class")
#fy.noimp <- rpart(formula = formulas[[2]], data = data, parms=list(split="information"), method = "class")
#fxy.noimp <- rpart(formula = formulas[[3]], data = data, parms=list(split="information"), method = "class")
## Model creation with imputation
#fx.withimp <- rpart(formula = formulas[[1]], data = x.complete, parms=list(split="information"), method = "class")
#fy.withimp <- rpart(formula = formulas[[2]], data = y.complete, parms=list(split="information"), method = "class")
#fxy.withimp <- rpart(formula = formulas[[3]], data = full.complete, parms=list(split="information"), method = "class")
xerrors
cps
#!/usr/bin/env Rscript
library(ggplot2)
# functions
# Setup
rm(list = ls())
setwd("~/workspace/github.com/ChrisLynch96/masters-project/scenario-template/graphs")
# Number of packets
## Data processing
data.packets = read.table("./data/rate-trace.txt", header=T)
data.packets$Node = factor(data.packets$Node)
data.packets = data.packets[c("Time", "Node", "PacketRaw")]
## Packet totals for each node
data.packets.nodes = aggregate(PacketRaw ~ Time + Node, data=data.packets, FUN=sum)
g.packets.nodes <- ggplot(data.packets.nodes) +
geom_line(aes (x=Time, y=PacketRaw), size=1) +
ylab("Number of packets") + facet_wrap(~ Node)
png("../results/sum.packets.nodes.png", width=1920, height=1080)
print(g.packets.nodes)
retval <- dev.off()
data.packets.total = aggregate(PacketRaw ~ Time, data=data.packets.nodes, FUN=sum)
g.packets.total <- ggplot(data.packets.total) +
geom_line(aes (x=Time, y=PacketRaw), size=1) +
ylab("Number of packets")
png("../results/sum.packets.total.png", width=1920, height=1080)
print(g.packets.total)
retval <- dev.off()
## Saving the relevant information
sum.packets = sum(data.packets.total$PacketRaw)
cat("total packets: ", sum.packets)
write.csv(data.packets.total,"../results/num.packets.csv", row.names = FALSE)
# Last Delay
data.delay = read.table("./data/app-delays-trace.txt", header=T)
## Data processing
data.delay.filtered <- data.delay[c("Time", "Type", "DelayS")]
data.delay.filtered <- data.delay.filtered[!data.delay.filtered$Type=="FullDelay",]
g.last.delay <- ggplot(data.delay.filtered) +
geom_line(aes (x=Time, y=DelayS), size=1) +
ylab("Delay (seconds)")
png("../results/delay.last.png", width=1920, height=1080)
print(g.last.delay)
retval <- dev.off()
## Saving the relevant information
write.csv(data.delay.filtered, "../results/last.delay.csv", row.names = FALSE)
### Average delay
mean.delay <- mean(data.delay.filtered$DelayS)
cat("Average delay:", mean.delay)
### Number of data packets received is num_rows/2
num.rows = nrow(data.delay)
cat("Number of data packets received:", num.rows/2)
#!/usr/bin/env Rscript
library(ggplot2)
# functions
# Setup
rm(list = ls())
setwd("~/workspace/github.com/ChrisLynch96/masters-project/scenario-template/graphs")
# Number of packets
## Data processing
data.packets = read.table("./data/rate-trace.txt", header=T)
data.packets$Node = factor(data.packets$Node)
data.packets = data.packets[c("Time", "Node", "PacketRaw")]
## Packet totals for each node
data.packets.nodes = aggregate(PacketRaw ~ Time + Node, data=data.packets, FUN=sum)
g.packets.nodes <- ggplot(data.packets.nodes) +
geom_line(aes (x=Time, y=PacketRaw), size=1) +
ylab("Number of packets") + facet_wrap(~ Node)
png("../results/sum.packets.nodes.png", width=1920, height=1080)
print(g.packets.nodes)
retval <- dev.off()
data.packets.total = aggregate(PacketRaw ~ Time, data=data.packets.nodes, FUN=sum)
g.packets.total <- ggplot(data.packets.total) +
geom_line(aes (x=Time, y=PacketRaw), size=1) +
ylab("Number of packets")
png("../results/sum.packets.total.png", width=1920, height=1080)
print(g.packets.total)
retval <- dev.off()
## Saving the relevant information
sum.packets = sum(data.packets.total$PacketRaw)
cat("total packets: ", sum.packets)
write.csv(data.packets.total,"../results/num.packets.csv", row.names = FALSE)
# Last Delay
data.delay = read.table("./data/app-delays-trace.txt", header=T)
## Data processing
data.delay.filtered <- data.delay[c("Time", "Type", "DelayS")]
data.delay.filtered <- data.delay.filtered[!data.delay.filtered$Type=="FullDelay",]
g.last.delay <- ggplot(data.delay.filtered) +
geom_line(aes (x=Time, y=DelayS), size=1) +
ylab("Delay (seconds)")
png("../results/delay.last.png", width=1920, height=1080)
print(g.last.delay)
retval <- dev.off()
## Saving the relevant information
write.csv(data.delay.filtered, "../results/last.delay.csv", row.names = FALSE)
### Average delay
mean.delay <- mean(data.delay.filtered$DelayS)
cat("Average delay:", mean.delay)
### Number of data packets received is num_rows/2
num.rows = nrow(data.delay)
cat("Number of data packets received:", num.rows/2)
